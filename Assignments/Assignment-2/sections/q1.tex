\section*{Problem 1}

\textbf{Principal Component Analysis (PCA)}

\begin{enumerate}[label= (\alph*), noitemsep, topsep=0pt]
    \item Bishop exercise 12.1 for the proof that the first M principal components correspond to the directions corresponding to the M largest eigenvectors of the covariance matrix (refer to Bishop page number 561--563 for problem formulation and proof for \( \mathrm{M}=1 \) and then prove for any arbitrary M by induction).
          This problem starts from the maximum variance formulation of PCA.\@

    \item Show that the minimum reconstruction error formulation of the PCA is equivalent to the maximum variance formulation.
\end{enumerate}

\subsection*{Solution}

\subsubsection*{(a) Maximum variance formulation of PCA}

Given a dataset containing \( n \) observations of \( d \)-dimensional data \( {\{ \mathbf{x}^{(i)} \}}_{i=1}^{n}, \quad \mathbf{x}^{(i)} \in \mathbb{R}^d \), we want to project this to an \( m (< d) \) dimensional subspace such that the variance of the projected data is maximized.
We will use mathematical induction to prove that the first \( m \) principal components correspond to the directions corresponding to the \( m \) largest eigenvectors of the covariance matrix \( \mathbf{S} \).

For \( m = 1 \), we have as follows.
Projecting the data onto a unit vector \( \mathbf{u}_1 \), i.e., with \( \mathbf{u}_1^\top \mathbf{u}_1 = 1 \) and \( \mathbf{u}_1 \in \mathbb{R}^d \), transforms each data point \( \mathbf{x}^{(i)} \) to \( \mathbf{u}_1^\top \mathbf{x}^{(i)} \).
The (sample) mean and variance of the projected data is given by
\begin{align*}
    \mu_1
     & =
    \frac{1}{n} \sum_{i=1}^{n} \mathbf{u}_1^\top \mathbf{x}^{(i)}
    =
    \mathbf{u}_1^\top \left( \frac{1}{n} \sum_{i=1}^{n} \mathbf{x}^{(i)} \right)
    =
    \mathbf{u}_1^\top \bar{\mathbf{x}},
    \\
    \sigma_1^2
     & =
    \frac{1}{n} \sum_{i=1}^{n} {( \mathbf{u}_1^\top \mathbf{x}^{(i)} - \mathbf{u}_1^\top \bar{\mathbf{x}} )}^2
    =
    \mathbf{u}_1^\top \left( \frac{1}{n} \sum_{i=1}^{n} {(\mathbf{x}^{(i)} - \bar{\mathbf{x}})}{(\mathbf{x}^{(i)} - \bar{\mathbf{x}})^\top} \right) \mathbf{u}_1
    =
    \mathbf{u}_1^\top \mathbf{S} \mathbf{u}_1,
\end{align*}
where \( \bar{\mathbf{x}} \) is the sample mean of the data and \( \mathbf{S} \) is the covariance matrix of the data.

We want to maximize the variance \( \sigma_1^2 \) subject to the constraint \( \mathbf{u}_1^\top \mathbf{u}_1 = 1 \), which is a constrained optimization problem.
Formulating the Lagrangian to convert it to an unconstrained optimization problem, we have, with \( \lambda_1 \) as the Lagrange multiplier,
\begin{equation*}
    \mathcal{L}(\mathbf{u}_1, \lambda)
    =
    \mathbf{u}_1^\top \mathbf{S} \mathbf{u}_1 + \lambda_1 (1 - \mathbf{u}_1^\top \mathbf{u}_1)
\end{equation*}
and the optimization problem is \( \max_{\mathbf{u}_1, \lambda_1} \mathcal{L}(\mathbf{u}_1, \lambda_1) \).
Differentiating \( \mathcal{L} \) with respect to \( \mathbf{u}_1 \) and setting it to zero, we get
\begin{align*}
    \frac{\partial \mathcal{L}}{\partial \mathbf{u}_1}
     & =
    2 \mathbf{S} \mathbf{u}_1 - 2 \lambda_1 \mathbf{u}_1
    =
    0
    \implies
    \mathbf{S} \mathbf{u}_1 = \lambda_1 \mathbf{u}_1
\end{align*}
which is the eigenvalue equation for the covariance matrix \( \mathbf{S} \).
Choosing \( \mathbf{u}_1 \) to be the eigenvector corresponding to the largest eigenvalue \( \lambda_1 \) of \( \mathbf{S} \) maximizes the variance of the projected data.
Thus, the first principal component corresponds to the direction of the eigenvector corresponding to the largest eigenvalue of the covariance matrix.

Similarly, by induction on \( m \), we can see that for projecting the data onto \( m \) unit vectors \( {\{ \mathbf{u}_j \}}_{j=1}^{m} \) such that \( \mathbf{u}_j^\top \mathbf{u}_j = 1, \quad \mathbf{u}_j \in \mathbb{R}^d, \quad j = 1, 2, \dots, m \quad \), the variance of the projected data is maximized when the \( m \) unit vectors are the eigenvectors corresponding to the \( m \) largest eigenvalues \( \lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_m \) of the covariance matrix \( \mathbf{S} \).

\subsubsection*{(b) Minimum reconstruction error of PCA}

Given the maximum variance formulation of PCA, we can derive the minimum reconstruction error formulation.
The mean and covariance matrix of the original dataset are given by
\begin{align*}
    \bar{\mathbf{x}}
     & =
    \frac{1}{N} \sum_{n=1}^{N} \mathbf{x}_n,
    \\
    \mathbf{S}
     & =
    \frac{1}{N} \sum_{n=1}^{N} {(\mathbf{x}_n - \bar{\mathbf{x}})}{(\mathbf{x}_n - \bar{\mathbf{x}})^\top}.
\end{align*}

The projection of the dataset onto the \( M \) principal components \( {\{ \mathbf{u}_m \}}_{m=1}^{M} \) is given by
\begin{align*}
    \mathbf{Z}
     & =
    \mathbf{U}_M^\top \mathbf{X},
\end{align*}
where \( \mathbf{U}_M = [\mathbf{u}_1, \mathbf{u}_2, \dots, \mathbf{u}_M] \) is the matrix of the \( M \) principal components.
The reconstruction of the dataset from the projected data is given by
\begin{align*}
    \mathbf{X}_{R}
     & =
    \mathbf{U}_M \mathbf{Z}
    =
    \mathbf{U}_M \mathbf{U}_M^\top \mathbf{X}.
\end{align*}

The minimum reconstruction error (MRE) is given by
\begin{align*}
    \text{MRE}
     & =
    \frac{1}{N} \sum_{n=1}^{N} \left \| \mathbf{x}_n - \mathbf{x}_{R, n} \right \|^2
    =
    \frac{1}{N} \sum_{n=1}^{N} (\mathbf{x}_n - \mathbf{x}_{R, n} )^\top (\mathbf{x}_n - \mathbf{x}_{R, n})
\end{align*}
